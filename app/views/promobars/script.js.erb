
$('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.4.0/animate.min.css">').prependTo('head');


<% unless @header_promobars.empty? %>
  <% @header_promobars.each_with_index do |bar, index| %>

    $('<div class="header-promo-bar<%= index %>" style="position: fixed; top: 0; width: 100%; ' +
      ' display: <%= bar.display_bar %>; ' +
      ' background: <%= bar.background_color %>; ' +
      ' text-align: <%= bar.text_align(bar.alignment)%>; ' +
      ' opacity: <%= (100 - bar.background_opacity) / 100.0 %>;">' +
      ' <h1 class="<%= bar.animation(bar.text_animation) %>" ' +
      ' style="display: inline-block; "><%= render html: bar.text.html_safe %></h1>' +
      ' <a href="' + '<%= bar.url_link %>' + '" target=<%= bar.link_blank %>' +  
      ' style="display: <%= bar.display_button %>; ' +
      ' border-radius: 5px;"' +
      ' class="btn btn-sm btn-primary"><%= render html: bar.button_text.html_safe unless bar.button_text.nil? %></a>' +
      ' <button id="header-promobar-x-button<%= index %>" class="btn btn-sm btn-primary"' +
      ' style="display: block; float: right; border-radius: 5px;"' + 
      ' type="button">X</button></div>').appendTo('body');
    $('<script type="text/javascript"> ' + 
        '$(document).ready(function () { ' +
          '$("#header-promobar-x-button<%= index %>").click(function () { ' +
             '$(".header-promo-bar<%= index %>").hide(); ' + 
          '}); ' +
          'if (!<%= bar.enabled_on_mobile? %>) { ' +
            'if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) { ' +
              '$(".header-promo-bar<%= index %>").css("visibility", "hidden"); ' +
            '} ' +
          '} ' +
        '}); ' +
    '</script>').appendTo('head');
    $('<style> ' + 
      '.header-promo-bar<%= index %> a:hover { ' +
      ' background-color: <%= bar.button_hover %> !important;' +
      '}' + 
    '</style>').appendTo('head');
    <% unless bar.subheader.nil? %>
      $('.site-header').after($('<div class="subheader-promo-bar<%= index %>" ' +
        ' style="width:100%; background: <%= bar.subheader.background_color %>; ' +
        /*' opacity: <%= (100 - bar.subheader.background_opacity) / 100.0 %>;">' +*/
        '<h2><%= render html: bar.subheader.text.html_safe unless bar.subheader.text.nil? %></h2></div>'));
    <% end %>
  <% end %>
  $('<script type="text/javascript"> ' + 
      '$(document).ready(function () { ' +
        'var divs = $(\'div[class^="header-promo-bar"]\'); ' +
        'divs.hide(); ' +
        'var i; ' +
        'i = 0; ' +
        '(function cycle() { ' +
          'divs.eq(i).fadeIn(400) ' +
                    '.delay(2000) ' +
                    '.fadeOut(400, cycle); ' +
          'i = ++i % divs.length; '  +
        '})(); ' +
      '}); ' +
    '</script>').appendTo('head');
<% end %>

<% unless @footer_promobars.nil? %>
  <% @footer_promobars.each_with_index do |bar, index| %>

    $('<div class="footer-promo-bar<%= index %>" style="position: fixed; bottom: 0; width: 100%;' +
      ' display: <%= bar.display_bar %>; ' +
      ' background: <%= bar.background_color %>; ' +
      ' text-align: <%= bar.text_align(bar.alignment)%>; ' +
      ' opacity: <%= (100 - bar.background_opacity) / 100.0 %>;">' +
      ' <h1 class="<%= bar.animation(bar.text_animation) %>" ' +
      ' style="display: inline-block; "><%= render html: bar.text.html_safe %></h1>' +
      ' <a href="' + '<%= bar.url_link %>' + '" target=<%= bar.link_blank %>' +  
      ' style="display: <%= bar.display_button %>; ' +
      ' border-radius: 5px;"' +
      ' class="btn btn-sm btn-primary"><%= render html: bar.button_text.html_safe unless bar.button_text.nil? %></a>' +
      ' <button id="header-promobar-x-button<%= index %>" class="btn btn-sm btn-primary"' +
      ' style="display: block; float: right; border-radius: 5px;"' + 
      ' type="button">X</button></div>').appendTo('body');
    $('<script type="text/javascript"> ' + 
        '$(document).ready(function () { ' +
          '$("#footer-promobar-x-button<%= index %>").click(function () { ' +
             '$(".footer-promo-bar<%= index %>").hide(); ' + 
          '});   ' +
          'if (!<%= bar.enabled_on_mobile? %>) { ' +
            'if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) { ' +
              '$(".footer-promo-bar<%= index %>").css("visibility", "hidden"); ' +
            '} ' +
          '} ' +
        '}); ' +
    '</script>').appendTo('head');
    $('<style> ' + 
      '.footer-promo-bar<%= index %> a:hover { ' +
      ' background-color: <%= bar.button_hover %> !important;' +
      '}' + 
    '</style>').appendTo('head');

  <% end %>
  $('<script type="text/javascript"> ' + 
      '$(document).ready(function () { ' +
        'var divs = $(\'div[class^="footer-promo-bar"]\'); ' +
        'divs.hide(); ' +
        'var i; ' +
        'i = 0; ' +
        '(function cycle() { ' +
          'divs.eq(i).fadeIn(400) ' +
                    '.delay(2000) ' +
                    '.fadeOut(400, cycle); ' +
          'i = ++i % divs.length; '  +
        '})(); ' +
      '}); ' +
    '</script>').appendTo('head');
<% end %>
